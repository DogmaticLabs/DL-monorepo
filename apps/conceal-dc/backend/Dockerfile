# ğŸ Base Image: Use an official Python image
FROM python:3.11-slim

# ğŸ› ï¸ Set Environment Variables
ENV PYTHONUNBUFFERED=1 \
    POETRY_VERSION=1.6.1 \
    DYNAMODB_ENDPOINT=https://dynamodb.us-east-1.amazonaws.com \
    REGION=us-east-1

# ğŸ“ Set Working Directory
WORKDIR /app

# ğŸ—‚ï¸ Copy only backend files
COPY . .

# ğŸ“¦ Install Dependencies
RUN pip install --upgrade pip \
    && pip install poetry==${POETRY_VERSION} \
    && poetry config virtualenvs.create false \
    && poetry install --without dev --no-root

# ğŸš€ Start the FastAPI Server
CMD ["uvicorn", "api:app", "--host", "0.0.0.0", "--port", "80"]
